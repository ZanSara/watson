{% extends "base_template.html" %}
{% block content %}
    
    <div class="text-center" style="padding: 1% 0;">
    
        <div id="loader" class="text-center">
            <p>Loading your photos...</p>
            <img src="../static/img/simple-pre-loader/images/loader-128x/Preloader_2.gif">
        </div>
    
        <div id="main-box" class="container" style="display:none;">
            <div class="col-md-8 col-md-offset-2" >
                <p class="lead">Scegli le foto che preferisci e premi Continua</p>     
                <div id="photo-container" class="text-center">

                    <div id="image">
                        <div class="inner-img">
                            <img id="img" src="../static/img/simple-pre-loader/images/loader-64x/Preloader_1.gif">
                            <img id="tick" src="../static/img/green-tick.png" class="green-tick" style="display:none;">
                            <a id="max-res-img" href="#" style="display:none;"></a>
                        </div>
                    </div>
                   
                </div>
                
                <form id="imageForm" style="margin-top:3%;" method="post" action="/results" >
                   	<input type="hidden" id="imageArray" name="imageArray" value="">
                    <button class="btn btn-danger btn-wide" onclick="prepareForm()">Continua</button>
                </form>
                
            </div>
        </div>
	    
    </div>


    <!-- Modal -->
    
    <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title text-center" id="myModalLabel">Ritaglia la tua immagine!</h4>
          </div>
          <div class="modal-body">
                <p>Ritaglia l'immagine e premi Salva</p>
                
                <div class="img-container" >
                <img id="img2crop" src="../static/img/sample_outfit.png" alt="Picture"  >
                
                <!--script>var images = document.getElementById('image2crop')</script-->
                
                </div>
          </div>
          <div class="modal-footer text-center">
          
            <button type="button" class="btn btn-default" data-dismiss="modal" >Chiudi</button>
            <button id="saveButton" type="button" class="btn btn-primary">Seleziona</button>

          </div>
        </div>
      </div>
    </div>
    
    <script>
        
        // lastPhotos sta in /static/js/utils.js
        document.addEventListener('DOMContentLoaded', lastPhotos() );

        // Codice di cropper.js
        document.addEventListener('DOMContentLoaded', function () {
 		
 		    // In questo modo sono passabili a utils.js
     		window.cropBoxData;
            window.canvasData;
            window.cropper;

            $('#myModal').on('shown.bs.modal', function () {
                cropper = new Cropper( document.getElementById('img2crop'), {
                    autoCropArea: 0.5,
                    ready: function () {
                        // Strict mode: set crop box data first
                        cropper.setCropBoxData(window.cropBoxData).setCanvasData(window.canvasData);
                    }
                });
            }).on('hidden.bs.modal', function () {
                cropper.destroy();
            });
      
        });
        
  </script>
    
    
{% endblock %}
