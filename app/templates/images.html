{% extends "base_template.html" %}
{% block content %}

<script src="http://code.jquery.com/jquery-1.10.2.js"></script>
<script src="http://code.jquery.com/ui/1.11.2/jquery-ui.js"></script>
<script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>

<div class="well">
        <h1 class="text-center">Hello World!</h1>
      </div>
      <div style="margin:5%;">
      <script>
      //It is necessary to install this extension of chrome
      //https://chrome.google.com/webstore/detail/allow-control-allow-origi/nlfbmbojpeacfghkpbjhddihlkkiljbi?hl=en-US
      function lastPhotos(){
    	  var access_token=(window.location.href).split("=")[1]
      var auth_code = location.search.split('code=')[1]
      var access_token=null
      authorize()
    	function authorize() {
    	  //this code is obtained by instagram api and
    	  //must be used to perform each call about a user
      var auth_code = location.search.split('code=')[1]
      var access_token=null
      authorize()
    	function authorize() {
    	  //this code is obtained by instagram api and
    	  //must be used to perform each call about a user
    	  $.ajax({

    		    type: 'POST',
    		    url: 'https://api.instagram.com/oauth/access_token',
    		    // Disable credentials as they were enabled by default
    		    xhrFields: {
    		        withCredentials: false
    		    },
    		    crossDomain: true,
    		    data: {
    		        client_id: "62f7b14a1a6141a58748d143744e1538",
    		        client_secret: "aa73a436fa564d7db469133cd40faaed",
    		        grant_type: 'authorization_code',
    		        redirect_uri: 'http://127.0.0.1:5000/images',
    		        code: auth_code
    		    },
    		    }).always(function(res) {
    		    console.log('Res from Instagram API', res);
    		    access_token=res.access_token
    		    });
      }
      function lastPhoto(){
    	  $.ajax({
    		    type: 'POST',
    		    url: 'https://api.instagram.com/oauth/access_token',
    		    // Disable credentials as they were enabled by default
    		    xhrFields: {
    		        withCredentials: false
    		    },
    		    crossDomain: true,
    		    data: {
    		        client_id: "62f7b14a1a6141a58748d143744e1538",
    		        client_secret: "aa73a436fa564d7db469133cd40faaed",
    		        grant_type: 'authorization_code',
    		        redirect_uri: 'http://127.0.0.1:5000/images',
    		        code: auth_code
    		    },
    		    }).always(function(res) {
    		    console.log('Res from Instagram API', res);
    		    access_token=res.access_token
    		    });
      }
      function lastPhoto(){
<<<<<<< HEAD
    	  $.ajax({
    		    type: 'POST',
    		    url: 'https://api.instagram.com/oauth/access_token',
    		    // Disable credentials as they were enabled by default
    		    xhrFields: {
    		        withCredentials: false
    		    },
    		    crossDomain: true,
    		    data: {
    		        client_id: "62f7b14a1a6141a58748d143744e1538",
    		        client_secret: "aa73a436fa564d7db469133cd40faaed",
    		        grant_type: 'authorization_code',
    		        redirect_uri: 'http://127.0.0.1:5000/images',
    		        code: auth_code
    		    },
    		    }).always(function(res) {
    		    console.log('Res from Instagram API', res);
    		    access_token=res.access_token
    		    });
      }
      function lastPhoto(){
=======
>>>>>>> refs/remotes/origin/master
    	  $.ajax({
  		    type: 'GET',
  		    url: 'https://api.instagram.com/v1/users/self/media/recent/?access_token='+access_token+"&count=10",
  		    // Disable credentials as they were enabled by default
  		    xhrFields: {
  		        withCredentials: false
  		    },
  		    crossDomain: true,
  		    
  		    }).always(function(res) {
  		    console.log('Res from Instagram API', res);
  		  	for (i = 0; i < res.data.length; i++) { 
  		  	var photo = document.createElement("IMG");
  		  	photo.setAttribute("src", res.data[i].images.thumbnail.url);
		  	document.getElementById("image").appendChild(photo);
  			}
  		  	
  		    });
    	  
      }
          </script>
      <button onclick="lastPhoto()">Import Photos</button>
      <div id="image"></div>
      </div>
{% endblock %}